function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function r(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(r,l){if(!l||"function"!=typeof l)throw new Error("epctrl require jQuery");var o=!1,s=!!document.all&&document.querySelector&&!document.addEventListener,e=function e(t){return t=t.toLowerCase(),epctrl._rootPath+"/"+t+"/"+t+".js"},i=function i(t){throw new Error(t)},n=function n(t){return l.ajax({url:e(t),type:"get",dataType:"TEXT",async:!1}).done(function(t){var e=document.createElement("script");e.text=t,document.getElementsByTagName("head")[0].appendChild(e)}).fail(i)},a=function a(t){"function"!=typeof epctrl[t]&&n(t)},c=function h(t,e,r){if("function"!=typeof e)return this;(r=r||{})._jsPromise||(r._jsPromise={});var n=t,o=n.prototype,s=e.prototype;if(n.superclass!=s){var i;for(i in n.superclass=s,n.superclass.constructor=e,s)o[i]=s[i];if(r)for(i in r)o[i]=r[i];return n}},u=function p(t,e){var r;if("function"==typeof t)r=t.prototype;else{if("object"!=_typeof(t))return this;r=t}for(var n in e)r[n]=e[n];return t},f=function f(){this._events={},this.cssUrl=[],this.jsUrl=[],this.htmlUrl="",this.htmlContainer=!1,this._FnQueues=[];var t=arguments[0].events;if(t)for(var e in t)t.hasOwnProperty(e)&&this.on(e,t[e]);this.on("afterCreate",this._onCreate)};f.prototype={type:"control",constructor:f,_jsPromise:{},_getControlPath:function t(){return"frame/fui/js/widgets/epcontrols/"+this.type.toLowerCase()+"/"},on:function m(t,e,r){return"string"!=typeof t?this.print("the first arguments type is requird as string","error"):"function"!=typeof e?this.print("the second arguments fn is requird as function","error"):(t=t.toLowerCase(),this._events[t]||(this._events[t]=[]),this._events[t].push(r?[e,r]:[e])),this},off:function d(t,e){t=t.toLowerCase();var r=this._events[t];if(!r||!r.length)return this;if(e)for(var n=0;n<r.length;++n)e===r[n][0]&&(r.splice(n,1),--n);else this._events[t]=r=[];return this},fire:function y(t,e){t=t.toLowerCase();var r,n=this._events[t],o=l.extend({type:t,origin:this,cancel:!1},e);if(!n)return o;for(var s=0,i=n.length;s<i;++s)r=n[s][0],o.scope=n[s][1]||this,r.call(o.scope,o);return o},one:function v(t,e,r){var n=this;function o(){n.off(t,o),e.apply(r||n,arguments)}return this.on(t,o,r),this},_loadJsPromise:function U(t){if(!t)return l.Deferred().resolve().promise();if(this._jsPromise[t])return this._jsPromise[t];var e=this,r=l.Deferred(),n=document.createElement("script");return n.type="text/javascript",(o||s)&&n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(r.resolve(),n.onreadystatechange=null)}:(n.onload=function(){r.resolve(),n.onload=null},n.onerror=function(){r.reject(),n.onerror=null,e._jsPromise[t]=null,i(t+"：此资源加载失败！")}),this.fire("beforeOneJsload",{jsUrl:t}),n.src=epctrl._rootPath+"/"+t,document.getElementsByTagName("head")[0].appendChild(n),this._jsPromise[t]=r.promise()},loadJs:function g(t,e){var r=l.Deferred();if(!t||!t.length)return"3"<=l.fn.jquery?l.Deferred().resolve().promise().then(function(){e&&e()}):(setTimeout(function(){r.resolve()}),r.promise().then(function(){e&&e()}));var n=this;"string"==typeof t&&(t=[t]),this.fire("beforeJsload",{jsUrl:t});var o=JSON.parse(JSON.stringify(t));function s(){return n.fire("afterOneJsload",{js:o[0]}),o.splice(0,1),o.length?n._loadJsPromise(o[0]).done(s).fail(n.throwError):(n.fire("afterJsLoad",{jsUrl:t}),l.Deferred().resolve().promise().then(function(){e&&e()}))}return this._loadJsPromise(o[0]).then(s)},loadCss:function j(t,e,r){"string"==typeof t&&(t=[t]);for(var n=null,o=(document.getElementsByTagName("head")[0],0),s=t.length;o<s;++o)document.getElementById("style-"+this.type+(1<s?"-"+o:""))||((n=document.createElement("link")).rel="stylesheet",n.id="style-"+this.type+(1<s?"-"+o:""),n.href=epctrl._rootPath+"/"+t[o])},loadHtml:function C(r){if(!r||!this.htmlContainer)return l.Deferred().resolve().promise();var t=this.fire("beforeHTMLLoad",{htmlUrl:r});this.htmlUrl=r=t.htmlUrl;var n=this;return l.ajax({url:epctrl._rootPath+"/"+r,type:"GET",async:!0,dataType:"HTML"}).done(function(t){var e=n.fire("beforeHtmlInsert",{htmlUrl:r,content:t,htmlContainer:n.htmlContainer});t=e.content,n.htmlContainer=e.htmlContainer,t&&n.htmlContainer&&l(t).appendTo(n.htmlContainer),n.fire("afterHTMLLoad",{htmlUrl:r,content:t,htmlContainer:n.htmlContainer})})},addCss:function _(t){if(t){var r=this.cssUrl;t+""===t&&(t=[t]),l.each(t,function(t,e){r.push(e)})}},setCss:function w(t){return t+""===t?this.cssUrl.push(t):this.cssUrl=t},setJs:function b(t){return t+""===t?this.jsUrl.push(t):this.jsUrl=t},setHtml:function E(t){return this.htmlUrl=t},setHtmlContainer:function P(t){return this.htmlContainer=t},getHtmlContainer:function S(){return this.htmlContainer},getHtml:function J(){return this.htmlUrl},getCss:function L(){return this.cssUrl},getJs:function T(){return this.jsUrl},addJs:function H(t){if(t){var r=this.jsUrl;t+""===t&&(t=[t]),l.each(t,function(t,e){r.push(e)})}},loadSource:function x(){var t=this,e=this.fire("beforeSourceLoad",{cssUrl:this.cssUrl,jsUrl:this.jsUrl});this.cssUrl=e.cssUrl,this.jsUrl=e.jsUrl,this.cssUrl&&this.loadCss(this.cssUrl),this.loadHtml(this.htmlUrl).then(function(){return t.loadJs(t.jsUrl,function(){t.fire("afterSourceLoad",{cssUrl:t.cssUrl,jsUrl:t.jsUrl}),t.create()})})},create:function D(){this.throwError("控件未提供初始化方法，初始化失败！")},_onCreate:function q(t){for(var e,r=t.origin,n=r._FnQueues;n.length;)(e=n.splice(0,1)[0])[0].apply(r,e[1])},_cacheFn:function N(t){if("function"==typeof t){var e=Array.prototype.slice.call(arguments,1);this._FnQueues.push([t,e])}else this.throwError("The first argument must be a function")},throwError:i,print:function O(t,e){if(r.console&&r.console.log)switch(e){case"info":console.log(t);break;case"warn":console.warn(t);break;case"error":console.error(t);break;default:console.log(t)}}},r.epctrl={_rootPath:"/component",extend:function h(t,e,r){var n=this[t.substr(0,1).toUpperCase()+t.substr(1)];if("function"!=typeof n)throw new Error("在epctrl下未找到"+t+"的定义，请确认控件名称正确！");return a(e),c(n,epctrl[e],r)},overwrite:function p(t,e){return a(t),u(epctrl[t],e)},Control:f,init:function Q(t,e){var r=t.substr(0,1).toUpperCase()+t.substr(1);if(!this[r]||"function"!=typeof this[r])throw new Error("指定的控件："+t+" 未找到，请确认控件名称正确！");var n=new this[r](e);return n.loadSource(),n}}}(this,jQuery);